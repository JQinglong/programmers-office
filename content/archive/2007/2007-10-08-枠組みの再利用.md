---
title: 枠組みの再利用
type: post
date: 2007-10-08T14:24:25+00:00
url: /枠組みの再利用/
post_views_count:
  - 116

---
LTで喋れなかった内容の続きその1。

再利用にもいろいろあり、枠組みだけを再利用したいということもあると思います。

たとえば、キーブレーク処理を書きたいという時に（RDBで集計等はできても、たまに書く必要がありますね）、以前書いたソースを持ってきても、実際の処理は全然違っていて、ただ処理フローだけをまねしたいのだが、コピペして不要なところを削っていくと結局ソース自体は丸々書き換えているということがあると思います。それでも、そのおかげでノンバグなら時間的にも品質的にもめでたしで終わると思いますが、修正元が複雑だったりすると直しているうちにわからなくなったり間違えたり・・・。

そういう時には、コピペ型の再利用ではなく、生成型の再利用がよいと思うのです。具体的には、コードスニペット。VisualStudioのせっかくの機能はこういうところで使うのがよいかなと思います。

ということでスニペットファイルを作ってみました（これでも、消すところはあるのですが、分かりやすさとのバランスが微妙ですね）。使い方は下記など参照。  
[コード スニペットの作成][1]  
[VBで独自のコード・スニペットを登録するには？［VS 2005のみ、VB］ － ＠IT][2]  
[[VS2005]コード スニペット マネージャが表示されないときの対処方法][3]

これもそうなのですが、再利用はひと手間かけることがポイントですかね。極端に言うと、「使ってもいいよ」ではなく「これでも使いませんか」くらい。

[「KeyBreak.zip」をダウンロード][4]

 [1]: http://msdn2.microsoft.com/ja-jp/library/ms165393(VS.80).aspx
 [2]: http://www.atmarkit.co.jp/fdotnet/dotnettips/448addcodesnippetvb/addcodesnippetvb.html
 [3]: http://blogs.sqlpassj.org/mitsugi/archive/2006/01/06/15462.aspx
 [4]: http://konnokiyotaka.txt-nifty.com/pgblog/files/KeyBreak.zip